<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        function doGet(e) {

            var sheet = SpreadsheetApp.getActive()
            var nse = sheet.getSheetByName("Sheet1")
            var data = [];
            var rlen = nse.getLastRow();
            var clen = nse.getLastColumn();
            var rows = nse.getRange(1, 1, rlen, clen).getValues();
            for (var i = 1; i < rows.length; i++) {
                var datarow = rows[i]
                var record = {}
                for (var j = 1; j < clen; j++) {
                    record[rows[0][j]] = datarow[j]

                }
                data.push(record);
            }
            console.log(data);
            var result = JSON.stringify(data)
            return ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON)


        }
    </script>

</body>

</html>